

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>1 Joining left, right and centre &#8212; Learn to code for data analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="_static/scripts/ou-book-theme.js?digest=70cd4f36c5f75a004a4184ab875fcbdab8e13f88"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'md_out_06_01';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2 Correlation" href="md_out_06_02.html" />
    <link rel="prev" title="3 Summary" href="md_out_05_03.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Learn to code for data analysis</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Learn to code for data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1: Having a go at it Part 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_00_01.html">Accessing the course software</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_00_02.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_00_03.html">3 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2: Having a go at it Part 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_01_01.html">1 Enter the pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_01_02.html">2 Writing up the analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_01_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_01_04.html">4 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3: Cleaning up our act Part 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_02_01.html">1 Weather data</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_02_02.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_02_03.html">4 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4: Cleaning up our act Part 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_03_01.html">1 Loading the weather data</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_03_02.html">2 Every picture tells a story</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_03_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_03_04.html">4 Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_03_05.html">4.1 Week 4 glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4: Cleaning up our act Part 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_04_01.html">1 Loading the weather data</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_04_02.html">2 Every picture tells a story</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_04_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_04_04.html">4 Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_04_05.html">4.1 Week 4 glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5: Combine and transform data Part 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_05_01.html">1 Life expectancy project</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_05_02.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_05_03.html">3 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6: Combine and transform data Part 2</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">1 Joining left, right and centre</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_06_02.html">2 Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_06_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_06_04.html">4 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7: Further techniques Part 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_07_01.html">1 I spy with my little eye</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_07_02.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_07_03.html">3 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8: Further techniques Part 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_08_01.html">1 The split-apply-combine pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_08_02.html">2 Pivot tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_08_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_08_04.html">4 Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_08_05.html">Tell us what you think</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/ouseful-demos/learn-to-code-jupyterlite" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/md_out_06_01.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1 Joining left, right and centre</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constant-variables">1.1 Constant variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-real">1.2 Getting real</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-up">1.3 Cleaning up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-and-transforming">1.4 Joining and transforming</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="joining-left-right-and-centre">
<h1>1 Joining left, right and centre<a class="headerlink" href="#joining-left-right-and-centre" title="Permalink to this heading">#</a></h1>
<p>Let’s take stock for a moment. There’s the original, unchanged table (with full country names) about the life expectancy:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">life</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country name</th>
<th>Life expectancy (years)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">75</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">Russia</td>
<td class="highlight_" rowspan="" colspan="">71</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">United States</td>
<td class="highlight_" rowspan="" colspan="">79</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">India</td>
<td class="highlight_" rowspan="" colspan="">66</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">United Kingdom</td>
<td class="highlight_" rowspan="" colspan="">81</td>
</tr>
</tbody>
</table>
<p>… and a table with the GDP in millions of pounds and also full country names.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">gdp</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country name</th>
<th>GDP (£m)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">United Kingdom</td>
<td class="highlight_" rowspan="" colspan="">1711727</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">United States</td>
<td class="highlight_" rowspan="" colspan="">10716029</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">5905202</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Brazil</td>
<td class="highlight_" rowspan="" colspan="">1435148</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">South Africa</td>
<td class="highlight_" rowspan="" colspan="">233937</td>
</tr>
</tbody>
</table>
<p>Both tables have a common column with a common name (‘Country name’). I can <strong>join</strong> the two tables on that common column, using the <code class="docutils literal notranslate"><span class="pre">merge()</span></code> function. Merging basically puts all columns of the two tables together, without duplicating the common column, and joins any rows that have the same value in the common column.</p>
<p>There are four possible ways of joining, depending on which rows I want to include in the resulting table. If I want to include only those countries appearing in the GDP table, I call the <code class="docutils literal notranslate"><span class="pre">merge()</span></code> function like so:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">merge(gdp,</span> <span class="pre">life,</span> <span class="pre">on='Country</span> <span class="pre">name',</span> <span class="pre">how='left')</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country name</th>
<th>GDP (£m)</th>
<th>Life expectancy (years)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">United Kingdom</td>
<td class="highlight_" rowspan="" colspan="">1711727</td>
<td class="highlight_" rowspan="" colspan="">81</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">United States</td>
<td class="highlight_" rowspan="" colspan="">10716029</td>
<td class="highlight_" rowspan="" colspan="">79</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">5905202</td>
<td class="highlight_" rowspan="" colspan="">75</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Brazil</td>
<td class="highlight_" rowspan="" colspan="">1435148</td>
<td class="highlight_" rowspan="" colspan="">NaN</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">South Africa</td>
<td class="highlight_" rowspan="" colspan="">233937</td>
<td class="highlight_" rowspan="" colspan="">NaN</td>
</tr>
</tbody>
</table>
<p>The first two arguments are the tables to be merged, with the first table being called the ‘left’ table and the second being the ‘right’ table. The <code class="docutils literal notranslate"><span class="pre">on</span></code> argument is the name of the common column, i.e. both tables must have a column with that name. The <code class="docutils literal notranslate"><span class="pre">how</span></code> argument states I want a <strong>left join</strong> , i.e. the resulting rows are dictated by the left (GDP) table. You can easily see that India and Russia, which appear only in the right (expectancy) table, don’t show up in the result. You can also see that Brazil and South Africa, which appear only in the left table, have an undefined life expectancy. (Remember that ‘NaN’ stands for ‘not a number.)</p>
<p>A <strong>right join</strong> will instead take the rows from the right table, and add the columns of the left table. Therefore, countries not appearing in the left table will have undefined values for the left table’s columns:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">merge(gdp,</span> <span class="pre">life,</span> <span class="pre">on='Country</span> <span class="pre">name',</span> <span class="pre">how='right')</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country name</th>
<th>GDP (£m)</th>
<th>Life expectancy (years)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">United Kingdom</td>
<td class="highlight_" rowspan="" colspan="">1711727</td>
<td class="highlight_" rowspan="" colspan="">81</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">United States</td>
<td class="highlight_" rowspan="" colspan="">10716029</td>
<td class="highlight_" rowspan="" colspan="">79</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">5905202</td>
<td class="highlight_" rowspan="" colspan="">75</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Russia</td>
<td class="highlight_" rowspan="" colspan="">NaN</td>
<td class="highlight_" rowspan="" colspan="">71</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">India</td>
<td class="highlight_" rowspan="" colspan="">NaN</td>
<td class="highlight_" rowspan="" colspan="">66</td>
</tr>
</tbody>
</table>
<p>The third possibility is an <strong>outer join</strong> which takes all countries, i.e. whether they are in the left or right table. The result has all the rows of the left and right joins:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">merge(gdp,</span> <span class="pre">life,</span> <span class="pre">on='Country</span> <span class="pre">name',</span> <span class="pre">how='outer')</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country name</th>
<th>GDP (£m)</th>
<th>Life expectancy (years)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">United Kingdom</td>
<td class="highlight_" rowspan="" colspan="">1711727</td>
<td class="highlight_" rowspan="" colspan="">81</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">United States</td>
<td class="highlight_" rowspan="" colspan="">10716029</td>
<td class="highlight_" rowspan="" colspan="">79</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">5905202</td>
<td class="highlight_" rowspan="" colspan="">75</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Brazil</td>
<td class="highlight_" rowspan="" colspan="">1435148</td>
<td class="highlight_" rowspan="" colspan="">NaN</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">South Africa</td>
<td class="highlight_" rowspan="" colspan="">233937</td>
<td class="highlight_" rowspan="" colspan="">NaN</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__5__</td>
<td class="highlight_" rowspan="" colspan="">Russia</td>
<td class="highlight_" rowspan="" colspan="">NaN</td>
<td class="highlight_" rowspan="" colspan="">71</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__6__</td>
<td class="highlight_" rowspan="" colspan="">India</td>
<td class="highlight_" rowspan="" colspan="">NaN</td>
<td class="highlight_" rowspan="" colspan="">66</td>
</tr>
</tbody>
</table>
<p>The last possibility is an <strong>inner join</strong> which takes only those countries common to both tables, i.e. for which I know the GDP <em>and</em> the life expectancy. That’s the join I want, to avoid any undefined values:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">gdpVsLife</span> <span class="pre">=</span> <span class="pre">merge(gdp,</span> <span class="pre">life,</span> <span class="pre">on='Country</span> <span class="pre">name',</span> <span class="pre">how='inner')</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country name</th>
<th>GDP (£m)</th>
<th>Life expectancy (years)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">United Kingdom</td>
<td class="highlight_" rowspan="" colspan="">1711727</td>
<td class="highlight_" rowspan="" colspan="">81</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">United States</td>
<td class="highlight_" rowspan="" colspan="">10716029</td>
<td class="highlight_" rowspan="" colspan="">79</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">5905202</td>
<td class="highlight_" rowspan="" colspan="">75</td>
</tr>
</tbody>
</table>
<p>Now it’s just a matter of applying the data transformation and combination techniques seen so far to the real data from the World Bank.</p>
<div class="admonition-activity-region-tags-style-activity admonition">
<p class="admonition-title">Activity<!-- #region tags=["style-activity"] --></p>
<p class="rubric">Exercise 5 Joining left, right and centre</p>
<p class="rubric">Question</p>
<p>Put your learning into practice by completing Exercise 5 in the Exercise notebook 3.</p>
<p>Remember to run the existing code in the notebook before you start the exercise. When you’ve completed the exercise, save the notebook.</p>
<!-- #endregion -->
</div>
<section id="constant-variables">
<h2>1.1 Constant variables<a class="headerlink" href="#constant-variables" title="Permalink to this heading">#</a></h2>
<p>You may have noticed that the same column names appear over and over in the code.</p>
<p>If, someday, I decide one of the new columns should be called ‘GDP (million GBP)’ instead of ‘GDP (£m)’ to make clear which currency is meant (because various countries use the pound symbol), I need to change the string in every line of code it occurs.</p>
<p><img alt="An abstract image of different coloured vertical strips with a column of numbers through each." src="ou_futurelearn_learn_to_code_fig_1053.jpg" /></p>
<p><strong>Figure 1</strong></p>
<p>Laziness is the mother of invention. If I assign the string to a variable and then use the variable everywhere instead of the string, whenever I wish to change the string, I only have to edit one line of code, where it’s assigned to the variable. A second advantage of using names instead of values is that I can use the name completion facility of Jupyter notebooks by pressing ‘TAB’. Writing code becomes much faster…</p>
<p><code class="docutils literal notranslate"><span class="pre">In[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">gdpInGbp</span> <span class="o">=</span> <span class="s1">&#39;GDP (million GBP)&#39;</span>
<span class="n">gdpInUsd</span> <span class="o">=</span> <span class="s1">&#39;GDP (US$)&#39;</span>
<span class="n">country</span> <span class="o">=</span> <span class="s1">&#39;Country name&#39;</span>
<span class="n">gdp</span><span class="p">[</span><span class="n">gdpInGbp</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp</span><span class="p">[</span><span class="n">gdpInUsd</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">usdToGbp</span><span class="p">)</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="n">country</span><span class="p">,</span> <span class="n">gdpInGbp</span><span class="p">]</span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">gdp</span><span class="p">[</span><span class="n">headings</span><span class="p">]</span>
</pre></div>
</div>
<p>Such variables are meant to be assigned once. They are called <strong>constants</strong> , because their value never changes. However, if someone else takes my code and wishes to adapt and extend it, they may not realise those variables are supposed to remain constant. Even I may forget it and try to assign a new value further down in the code! To help prevent such slip-ups the Python convention is to write names of constants in uppercase letters, with words separated by underscores. Thus, any further assignment to a variable in uppercase will ring an alarm bell (in your head, the computer remains silent).</p>
<p><code class="docutils literal notranslate"><span class="pre">In[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">GDP_GBP</span> <span class="o">=</span> <span class="s1">&#39;GDP (million GBP)&#39;</span>
<span class="n">GDP_USD</span> <span class="o">=</span> <span class="s1">&#39;GDP (US$)&#39;</span>
<span class="n">COUNTRY</span> <span class="o">=</span> <span class="s1">&#39;Country name&#39;</span>
<span class="n">gdp</span><span class="p">[</span><span class="n">GDP_GBP</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp</span><span class="p">[</span><span class="n">GDP_USD</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">usdToGbp</span><span class="p">)</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="n">COUNTRY</span><span class="p">,</span> <span class="n">GDP_GBP</span><span class="p">]</span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">gdp</span><span class="p">[</span><span class="n">headings</span><span class="p">]</span>
</pre></div>
</div>
<p>Using constants is not just a matter of laziness. There are various advantages. First, constants stand out in the code.</p>
<p>Second, when making changes to the repeated values throughout the code, it’s easy to miss an occurrence. Using constants means the code is always consistent throughout.</p>
<p>Third, the name of the constant can help clarify what the value means. For example, instead of using the number 1995 throughout the code, define a constant that makes clear whether it’s a year, the cubic centimetres of a car engine or something else.</p>
<p>To sum up, using constants makes the code clearer, easier to change, and less prone to silly (but hard to find) mistakes due to inconsistent values.</p>
<p>Any value can be defined as a constant, whether it’s a string, a number or even a dataframe. For example, you could store the data you have loaded from the file into a constant, as a reminder to not change the original data. In the rest of the week, I’ll use constants mainly for the column names.</p>
<div class="admonition-activity-region-tags-style-activity admonition">
<p class="admonition-title">Activity<!-- #region tags=["style-activity"] --></p>
<p class="rubric">Exercise 6 Constants</p>
<p class="rubric">Question</p>
<p>To practise using constants, rewrite your exercises in the Exercise notebook 3 using them.</p>
<!-- #endregion -->
</div>
</section>
<section id="getting-real">
<h2>1.2 Getting real<a class="headerlink" href="#getting-real" title="Permalink to this heading">#</a></h2>
<p>Having tried out the data transformations and combination on small tables, I feel confident about using the full data from the World Bank, which I pointed you to in Life expectancy project.</p>
<p>Open a new browser window and go to the World Bank’s <a class="reference external" href="http://data.worldbank.org/">data page</a>. Type ‘GDP’ (without the quote marks) in the ‘Find an indicator’ box in the centre of the page and select ‘GDP current US$’. Click ‘Go’. This will take you to the data page you looked at earlier. Look at the top of your browser window. You will notice the URL is <a class="reference external" href="http://data.worldbank.org/indicator/NY.GDP.MKTP.CD">http://data.worldbank.org/indicator/NY.GDP.MKTP.CD</a>. Every World Bank dataset is for an indicator (in this case GDP in current dollars) with a unique name (in this case <a class="reference external" href="http://NY.GDP.MKTP.CD">NY.GDP.MKTP.CD</a>).</p>
<p>Knowing the indicator name, it’s a doddle to get the data directly into a dataframe, by using the <code class="docutils literal notranslate"><span class="pre">download()</span></code> function of the <code class="docutils literal notranslate"><span class="pre">wb</span></code> (World Bank) module, instead of first downloading a CSV or Excel file and then loading it into a dataframe. (Note that CoCalc’s free plan doesn’t allow connecting to other sites, so if you are using CoCalc you’ll need to download the data as a CSV or Excel file from the World Bank and upload it to CoCalc.)</p>
<p>Here’s the code to get the 2013 GDP values for all countries. It may take a little while for the code to fetch the data.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="kn">from</span> <span class="nn">pandas.io.wb</span> <span class="kn">import</span> <span class="n">download</span> 
<span class="n">YEAR</span> <span class="o">=</span> <span class="mi">2013</span>
<span class="n">GDP_INDICATOR</span> <span class="o">=</span> <span class="s1">&#39;NY.GDP.MKTP.CD&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">download</span><span class="p">(</span><span class="n">indicator</span><span class="o">=</span><span class="n">GDP_INDICATOR</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
              <span class="n">start</span><span class="o">=</span><span class="n">YEAR</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">YEAR</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th></th>
<th>NY.GDP.MKTP.CD</th>
</tr>
<tr>
<th>__country__</th>
<th>year</th>
<th></th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__Arab World__</td>
<td class="highlight_" rowspan="" colspan="">__2013__</td>
<td class="highlight_" rowspan="" colspan="">2.843483e+12</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__Caribbean small states__</td>
<td class="highlight_" rowspan="" colspan="">__2013__</td>
<td class="highlight_" rowspan="" colspan="">6.680344e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__Central Europe and the Baltics__</td>
<td class="highlight_" rowspan="" colspan="">__2013__</td>
<td class="highlight_" rowspan="" colspan="">1.418166e+12</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__East Asia &amp; Pacific (all income levels)__</td>
<td class="highlight_" rowspan="" colspan="">__2013__</td>
<td class="highlight_" rowspan="" colspan="">2.080794e+13</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__East Asia &amp; Pacific (developing only)__</td>
<td class="highlight_" rowspan="" colspan="">__2013__</td>
<td class="highlight_" rowspan="" colspan="">1.168563e+13</td>
</tr>
</tbody>
</table>
<p>This table definitely has an odd shape. The three columns don’t have their headings side by side, and the row numbering (0, 1, 2, etc) is missing. That’s because the first two ‘columns’ are in fact the dataframe index. You saw a similar table in <a class="reference external" href="https://www.open.edu/openlearn/mod/oucontent/olink.php?id=83250&amp;targetdoc=Week+4%3A+Cleaning+up+our+act+Part+2&amp;targetptr=2.1">Changing a dataframe’s index,</a> when the index of the weather dataframe was set to be the ‘GMT’ column, with values of type <code class="docutils literal notranslate"><span class="pre">datetime64</span></code>. There’s a dataframe method to do the inverse, i.e. to transform the row names into column values and thereby reinstate the default dataframe index.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">gdp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>year</th>
<th>NY.GDP.MKTP.CD</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">Arab World</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">2.843483e+12</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">Caribbean small states</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">6.680344e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">Central Europe and the Baltics</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">1.418166e+12</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">East Asia &amp; Pacific (all income levels)</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">2.080794e+13</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">East Asia &amp; Pacific (developing only)</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">1.168563e+13</td>
</tr>
</tbody>
</table>
<p>I repeat the whole process for the life expectancy:</p>
<ul class="simple">
<li><p>search for ‘life expectancy’ on the World Bank site</p></li>
<li><p>choose the ‘total’ dataset, which includes both female and male inhabitants</p></li>
<li><p>note down its indicator (<a class="reference external" href="http://SP.DYN.LE00.IN">SP.DYN.LE00.IN</a>)</p></li>
<li><p>use it to get the data</p></li>
<li><p>reset the dataframe index.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">LIFE_INDICATOR</span> <span class="o">=</span> <span class="s1">&#39;SP.DYN.LE00.IN&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">download</span><span class="p">(</span><span class="n">indicator</span><span class="o">=</span><span class="n">LIFE_INDICATOR</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
              <span class="n">start</span><span class="o">=</span><span class="n">YEAR</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">YEAR</span><span class="p">)</span>
<span class="n">life</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">life</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>year</th>
<th>SP.DYN.LE00.IN</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">Arab World</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">70.086392</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">Caribbean small states</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">71.966306</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">Central Europe and the Baltics</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">76.127583</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">East Asia &amp; Pacific (all income levels)</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">74.893439</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">East Asia &amp; Pacific (developing only)</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">73.981255</td>
</tr>
</tbody>
</table>
<p>By defining the year as a constant, it’s very quick to change the code to load both datasets for any other year. If you wish to get GDP data for an earlier year than for life expectancy, then you need to define a second constant.</p>
<div class="admonition-activity-region-tags-style-activity admonition">
<p class="admonition-title">Activity<!-- #region tags=["style-activity"] --></p>
<p class="rubric">Exercise 7 Getting real</p>
<p class="rubric">Question</p>
<p>The approach described above requires an internet connection to download the data directly from the World Bank. That may require some time, or sometimes not even work if the connection fails. Moreover, the World Bank sometimes changes its data format, which could break the code in the rest of this week.</p>
<p>Therefore, the Exercise notebook 3 loads instead the GDP and life expectancy data from files WB GDP 2013.csv and WB LE 2013.csv and Exercise 7 uses the file WB POP 2013.csv , which you should add to your disk folder or CoCalc project. All files are in the normal tabular format and need no resetting of the indices.</p>
<!-- #endregion -->
</div>
</section>
<section id="cleaning-up">
<h2>1.3 Cleaning up<a class="headerlink" href="#cleaning-up" title="Permalink to this heading">#</a></h2>
<p>You may have noticed that the initial rows are not about countries, but groups of countries. Such aggregated values need to be removed, because we’re only interested in individual countries.</p>
<p>The expression <code class="docutils literal notranslate"><span class="pre">frame[m:n],</span></code> with <code class="docutils literal notranslate"><span class="pre">n</span></code> an integer bigger than <code class="docutils literal notranslate"><span class="pre">m</span></code> , represents the ‘sub-table’ from row <code class="docutils literal notranslate"><span class="pre">m</span></code> to row <code class="docutils literal notranslate"><span class="pre">n-1</span></code>. In other words, it is a slice of frame with exactly <code class="docutils literal notranslate"><span class="pre">n</span></code> minus <code class="docutils literal notranslate"><span class="pre">m</span></code> rows. The expression is equivalent to the more convoluted expression <code class="docutils literal notranslate"><span class="pre">frame.head(n).tail(n-m)</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">gdp[0:3]</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>year</th>
<th>NY.GDP.MKTP.CD</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">Arab World</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">2.843483e+12</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">Caribbean small states</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">6.680344e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">Central Europe and the Baltics</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">1.418166e+12</td>
</tr>
</tbody>
</table>
<p>To slice all rows from <code class="docutils literal notranslate"><span class="pre">m</span></code> onwards, you don’t have to count how many rows there are beforehand, just omit <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">gdp[240:]</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>year</th>
<th>NY.GDP.MKTP.CD</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__240__</td>
<td class="highlight_" rowspan="" colspan="">Uzbekistan</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">5.679566e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__241__</td>
<td class="highlight_" rowspan="" colspan="">Vanuatu</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">8.017876e+08</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__242__</td>
<td class="highlight_" rowspan="" colspan="">Venezuela, RB</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">3.713366e+11</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__243__</td>
<td class="highlight_" rowspan="" colspan="">Vietnam</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">1.712220e+11</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__244__</td>
<td class="highlight_" rowspan="" colspan="">Virgin Islands (U.S.)</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">NaN</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__245__</td>
<td class="highlight_" rowspan="" colspan="">West Bank and Gaza</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">1.247600e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__246__</td>
<td class="highlight_" rowspan="" colspan="">Yemen, Rep.</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">3.595450e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__247__</td>
<td class="highlight_" rowspan="" colspan="">Zambia</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">2.682081e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__248__</td>
<td class="highlight_" rowspan="" colspan="">Zimbabwe</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">1.349023e+10</td>
</tr>
</tbody>
</table>
<p>By trying out <code class="docutils literal notranslate"><span class="pre">head(m)</span></code> for different values of <code class="docutils literal notranslate"><span class="pre">m</span></code> , I find that the list of individual countries starts in row number 34, with Afghanistan. Hence, I slice from row 34 onwards, and that’s my new dataframe.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">gdp</span><span class="p">[</span><span class="mi">34</span><span class="p">:]</span>
<span class="n">gdp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>year</th>
<th>NY.GDP.MKTP.CD</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__34__</td>
<td class="highlight_" rowspan="" colspan="">Afghanistan</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">2.031088e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__35__</td>
<td class="highlight_" rowspan="" colspan="">Albania</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">1.291667e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__36__</td>
<td class="highlight_" rowspan="" colspan="">Algeria</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">2.101834e+11</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__37__</td>
<td class="highlight_" rowspan="" colspan="">American Samoa</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">NaN</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__38__</td>
<td class="highlight_" rowspan="" colspan="">Andorra</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">3.249101e+09</td>
</tr>
</tbody>
</table>
<p>Unsurprisingly, there is missing data, so I remove those rows, as shown in <a class="reference external" href="https://www.open.edu/openlearn/mod/oucontent/olink.php?id=83250&amp;targetdoc=Week+4%3A+Cleaning+up+our+act+Part+2&amp;targetptr=1.3">Missing values</a> in Week 4.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">gdp</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">gdp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>year</th>
<th>NY.GDP.MKTP.CD</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__34__</td>
<td class="highlight_" rowspan="" colspan="">Afghanistan</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">2.031088e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__35__</td>
<td class="highlight_" rowspan="" colspan="">Albania</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">1.291667e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__36__</td>
<td class="highlight_" rowspan="" colspan="">Algeria</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">2.101834e+11</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__38__</td>
<td class="highlight_" rowspan="" colspan="">Andorra</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">3.249101e+09</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__39__</td>
<td class="highlight_" rowspan="" colspan="">Angola</td>
<td class="highlight_" rowspan="" colspan="">2013</td>
<td class="highlight_" rowspan="" colspan="">1.241632e+11</td>
</tr>
</tbody>
</table>
<p>Finally, I drop the irrelevant year column.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">COUNTRY</span> <span class="o">=</span> <span class="s1">&#39;country&#39;</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="n">COUNTRY</span><span class="p">,</span> <span class="n">GDP_INDICATOR</span><span class="p">]</span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">gdp</span><span class="p">[</span><span class="n">headings</span><span class="p">]</span>
<span class="n">gdp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>NY.GDP.MKTP.CD</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__34__</td>
<td class="highlight_" rowspan="" colspan="">Afghanistan</td>
<td class="highlight_" rowspan="" colspan="">2.031088e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__35__</td>
<td class="highlight_" rowspan="" colspan="">Albania</td>
<td class="highlight_" rowspan="" colspan="">1.291667e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__36__</td>
<td class="highlight_" rowspan="" colspan="">Algeria</td>
<td class="highlight_" rowspan="" colspan="">2.101834e+11</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__38__</td>
<td class="highlight_" rowspan="" colspan="">Andorra</td>
<td class="highlight_" rowspan="" colspan="">3.249101e+09</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__39__</td>
<td class="highlight_" rowspan="" colspan="">Angola</td>
<td class="highlight_" rowspan="" colspan="">1.241632e+11</td>
</tr>
</tbody>
</table>
<p>And now I repeat the whole cleaning process for the life expectancy table.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="n">COUNTRY</span><span class="p">,</span> <span class="n">LIFE_INDICATOR</span><span class="p">]</span>
<span class="n">life</span> <span class="o">=</span> <span class="n">life</span><span class="p">[</span><span class="mi">34</span><span class="p">:]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="n">headings</span><span class="p">]</span>
<span class="n">life</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>SP.DYN.LE00.IN</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__34__</td>
<td class="highlight_" rowspan="" colspan="">Afghanistan</td>
<td class="highlight_" rowspan="" colspan="">60.931415</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__35__</td>
<td class="highlight_" rowspan="" colspan="">Albania</td>
<td class="highlight_" rowspan="" colspan="">77.537244</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__36__</td>
<td class="highlight_" rowspan="" colspan="">Algeria</td>
<td class="highlight_" rowspan="" colspan="">71.009659</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__39__</td>
<td class="highlight_" rowspan="" colspan="">Angola</td>
<td class="highlight_" rowspan="" colspan="">51.866171</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__40__</td>
<td class="highlight_" rowspan="" colspan="">Antigua and Barbuda</td>
<td class="highlight_" rowspan="" colspan="">75.829293</td>
</tr>
</tbody>
</table>
<p>Note how a single line of code can chain a row slice, a method call and a column slice, because each takes a dataframe and returns a dataframe.</p>
<div class="admonition-activity-region-tags-style-activity admonition">
<p class="admonition-title">Activity<!-- #region tags=["style-activity"] --></p>
<p class="rubric">Exercise 8 Cleaning up</p>
<p class="rubric">Question</p>
<p>Clean up the population data from Exercise 7, in Exercise 8 in the exercise notebook 3.</p>
<!-- #endregion -->
</div>
</section>
<section id="joining-and-transforming">
<h2>1.4 Joining and transforming<a class="headerlink" href="#joining-and-transforming" title="Permalink to this heading">#</a></h2>
<p>With the little tables, I first transformed the columns and then joined the tables.</p>
<p><img alt="An image of a bride and groom holding hands with the minister between them in the background" src="ou_futurelearn_learn_to_code_fig_1054.jpg" /></p>
<p><strong>Figure 2</strong></p>
<p>As you may be starting to realise, there’s often more than one way to do it. Just for illustration, I’ll do the other way round for the big tables. Here are the tables, as a reminder.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">life.head()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>SP.DYN.LE00.IN</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__34__</td>
<td class="highlight_" rowspan="" colspan="">Afghanistan</td>
<td class="highlight_" rowspan="" colspan="">60.931415</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__35__</td>
<td class="highlight_" rowspan="" colspan="">Albania</td>
<td class="highlight_" rowspan="" colspan="">77.537244</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__36__</td>
<td class="highlight_" rowspan="" colspan="">Algeria</td>
<td class="highlight_" rowspan="" colspan="">71.009659</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__39__</td>
<td class="highlight_" rowspan="" colspan="">Angola</td>
<td class="highlight_" rowspan="" colspan="">51.866171</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__40__</td>
<td class="highlight_" rowspan="" colspan="">Antigua and Barbuda</td>
<td class="highlight_" rowspan="" colspan="">75.829293</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">gdp.head()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>NY.GDP.MKTP.CD</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__34__</td>
<td class="highlight_" rowspan="" colspan="">Afghanistan</td>
<td class="highlight_" rowspan="" colspan="">2.031088e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__35__</td>
<td class="highlight_" rowspan="" colspan="">Albania</td>
<td class="highlight_" rowspan="" colspan="">1.291667e+10</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__36__</td>
<td class="highlight_" rowspan="" colspan="">Algeria</td>
<td class="highlight_" rowspan="" colspan="">2.101834e+11</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__38__</td>
<td class="highlight_" rowspan="" colspan="">Andorra</td>
<td class="highlight_" rowspan="" colspan="">3.249101e+09</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__39__</td>
<td class="highlight_" rowspan="" colspan="">Angola</td>
<td class="highlight_" rowspan="" colspan="">1.241632e+11</td>
</tr>
</tbody>
</table>
<p>First, an inner join on the common column to combine rows where the common column value appears in both tables.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>

<span class="n">gdpVsLife</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">gdp</span><span class="p">,</span> <span class="n">life</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

<span class="n">gdpVsLife</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out</span> <span class="pre">[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>NY.GDP.MKTP.CD</th>
<th>SP.DYN.LE00.IN</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">Afghanistan</td>
<td class="highlight_" rowspan="" colspan="">2.031088e+10</td>
<td class="highlight_" rowspan="" colspan="">60.931415</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">Albania</td>
<td class="highlight_" rowspan="" colspan="">1.291667e+10</td>
<td class="highlight_" rowspan="" colspan="">77.537244</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">Algeria</td>
<td class="highlight_" rowspan="" colspan="">2.101834e+11</td>
<td class="highlight_" rowspan="" colspan="">71.009659</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Angola</td>
<td class="highlight_" rowspan="" colspan="">1.241632e+11</td>
<td class="highlight_" rowspan="" colspan="">51.866171</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">Antigua and Barbuda</td>
<td class="highlight_" rowspan="" colspan="">1.200588e+09</td>
<td class="highlight_" rowspan="" colspan="">75.829293</td>
</tr>
</tbody>
</table>
<p>Second, the dollars are converted to millions of pounds.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">GDP</span> <span class="o">=</span> <span class="s1">&#39;GDP (£m)&#39;</span>
<span class="n">column</span> <span class="o">=</span> <span class="n">gdpVsLife</span><span class="p">[</span><span class="n">GDP_INDICATOR</span><span class="p">]</span>

<span class="n">gdpVsLife</span><span class="p">[</span><span class="n">GDP</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">usdToGbp</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">roundToMillions</span><span class="p">)</span>

<span class="n">gdpVsLife</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>NY.GDP.MKTP.CD</th>
<th>SP.DYN.LE00.IN</th>
<th>GDP (£m)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">Afghanistan</td>
<td class="highlight_" rowspan="" colspan="">2.031088e+10</td>
<td class="highlight_" rowspan="" colspan="">60.931415</td>
<td class="highlight_" rowspan="" colspan="">12980</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">Albania</td>
<td class="highlight_" rowspan="" colspan="">1.291667e+10</td>
<td class="highlight_" rowspan="" colspan="">77.537244</td>
<td class="highlight_" rowspan="" colspan="">8255</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">Algeria</td>
<td class="highlight_" rowspan="" colspan="">2.101834e+11</td>
<td class="highlight_" rowspan="" colspan="">71.009659</td>
<td class="highlight_" rowspan="" colspan="">134322</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Angola</td>
<td class="highlight_" rowspan="" colspan="">1.241632e+11</td>
<td class="highlight_" rowspan="" colspan="">51.866171</td>
<td class="highlight_" rowspan="" colspan="">79349</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">Antigua and Barbuda</td>
<td class="highlight_" rowspan="" colspan="">1.200588e+09</td>
<td class="highlight_" rowspan="" colspan="">75.829293</td>
<td class="highlight_" rowspan="" colspan="">767</td>
</tr>
</tbody>
</table>
<p>Third, the life expectancy is rounded to the nearest integer, with a by now familiar function.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">LIFE</span> <span class="o">=</span> <span class="s1">&#39;Life expectancy (years)&#39;</span>

<span class="n">gdpVsLife</span><span class="p">[</span><span class="n">LIFE</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdpVsLife</span><span class="p">[</span><span class="n">LIFE_INDICATOR</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">round</span><span class="p">)</span>

<span class="n">gdpVsLife</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>NY.GDP.MKTP.CD</th>
<th>SP.DYN.LE00.IN</th>
<th>GDP (£m)</th>
<th>Life expectancy (years)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">Afghanistan</td>
<td class="highlight_" rowspan="" colspan="">2.031088e+10</td>
<td class="highlight_" rowspan="" colspan="">60.931415</td>
<td class="highlight_" rowspan="" colspan="">12980</td>
<td class="highlight_" rowspan="" colspan="">61</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">Albania</td>
<td class="highlight_" rowspan="" colspan="">1.291667e+10</td>
<td class="highlight_" rowspan="" colspan="">77.537244</td>
<td class="highlight_" rowspan="" colspan="">8255</td>
<td class="highlight_" rowspan="" colspan="">78</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">Algeria</td>
<td class="highlight_" rowspan="" colspan="">2.101834e+11</td>
<td class="highlight_" rowspan="" colspan="">71.009659</td>
<td class="highlight_" rowspan="" colspan="">134322</td>
<td class="highlight_" rowspan="" colspan="">71</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Angola</td>
<td class="highlight_" rowspan="" colspan="">1.241632e+11</td>
<td class="highlight_" rowspan="" colspan="">51.866171</td>
<td class="highlight_" rowspan="" colspan="">79349</td>
<td class="highlight_" rowspan="" colspan="">52</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">Antigua and Barbuda</td>
<td class="highlight_" rowspan="" colspan="">1.200588e+09</td>
<td class="highlight_" rowspan="" colspan="">75.829293</td>
<td class="highlight_" rowspan="" colspan="">767</td>
<td class="highlight_" rowspan="" colspan="">76</td>
</tr>
</tbody>
</table>
<p>Lastly, the original columns are discarded.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="n">COUNTRY</span><span class="p">,</span> <span class="n">GDP</span><span class="p">,</span> <span class="n">LIFE</span><span class="p">]</span>
<span class="n">gdpVsLife</span> <span class="o">=</span> <span class="n">gdpVsLife</span><span class="p">[</span><span class="n">headings</span><span class="p">]</span>
<span class="n">gdpVsLife</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>country</th>
<th>GDP (£m)</th>
<th>Life expectancy (years)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">Afghanistan</td>
<td class="highlight_" rowspan="" colspan="">12980</td>
<td class="highlight_" rowspan="" colspan="">61</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">Albania</td>
<td class="highlight_" rowspan="" colspan="">8255</td>
<td class="highlight_" rowspan="" colspan="">78</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">Algeria</td>
<td class="highlight_" rowspan="" colspan="">134322</td>
<td class="highlight_" rowspan="" colspan="">71</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Angola</td>
<td class="highlight_" rowspan="" colspan="">79349</td>
<td class="highlight_" rowspan="" colspan="">52</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">Antigua and Barbuda</td>
<td class="highlight_" rowspan="" colspan="">767</td>
<td class="highlight_" rowspan="" colspan="">76</td>
</tr>
</tbody>
</table>
<p>For the first five countries there doesn’t seem to be any relation between wealth and life expectancy, but that might be just for those countries.</p>
<div class="admonition-activity-region-tags-style-activity admonition">
<p class="admonition-title">Activity<!-- #region tags=["style-activity"] --></p>
<p class="rubric">Exercise 9 Joining and transforming</p>
<p class="rubric">Question</p>
<p>Have a go at merging dataframes with an inner join in Exercise 9 in the Exercise notebook 3.</p>
<!-- #endregion -->
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ouseful-demos/learn-to-code-jupyterlite",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="md_out_05_03.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">3 Summary</p>
      </div>
    </a>
    <a class="right-next"
       href="md_out_06_02.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2 Correlation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constant-variables">1.1 Constant variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-real">1.2 Getting real</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-up">1.3 Cleaning up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-and-transforming">1.4 Joining and transforming</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By OpenLearn
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>