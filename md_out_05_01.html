

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>1 Life expectancy project &#8212; Learn to code for data analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'md_out_05_01';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2 This week’s quiz" href="md_out_05_02.html" />
    <link rel="prev" title="4.1 Week 4 glossary" href="md_out_04_05.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Learn to code for data analysis</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Learn to code for data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1: Having a go at it Part 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_00_01.html">1 Install the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_00_02.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_00_03.html">3 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2: Having a go at it Part 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_01_01.html">1 Enter the pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_01_02.html">2 Writing up the analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_01_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_01_04.html">4 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3: Cleaning up our act Part 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_02_01.html">1 Weather data</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_02_02.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_02_03.html">4 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4: Cleaning up our act Part 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_03_01.html">1 Loading the weather data</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_03_02.html">2 Every picture tells a story</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_03_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_03_04.html">4 Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_03_05.html">4.1 Week 4 glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4: Cleaning up our act Part 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_04_01.html">1 Loading the weather data</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_04_02.html">2 Every picture tells a story</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_04_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_04_04.html">4 Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_04_05.html">4.1 Week 4 glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5: Combine and transform data Part 1</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">1 Life expectancy project</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_05_02.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_05_03.html">3 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6: Combine and transform data Part 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_06_01.html">1 Joining left, right and centre</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_06_02.html">2 Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_06_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_06_04.html">4 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7: Further techniques Part 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_07_01.html">1 I spy with my little eye</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_07_02.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_07_03.html">3 Summary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8: Further techniques Part 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="md_out_08_01.html">1 The split-apply-combine pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_08_02.html">2 Pivot tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_08_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_08_04.html">4 Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_out_08_05.html">Tell us what you think</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/ouseful-demos/learn-to-code-jupyterlite" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/md_out_05_01.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1 Life expectancy project</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#links">Links:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-data">1.1 Creating the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-functions">1.2 Defining functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-if">1.3 What if…?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-functions">1.4 Applying functions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="life-expectancy-project">
<h1>1 Life expectancy project<a class="headerlink" href="#life-expectancy-project" title="Permalink to this heading">#</a></h1>
<p>This week I wish to see (literally, via a chart) if the life expectancy in richer countries tends to be longer.</p>
<p><img alt="A photograph of an adult hand holding the hand of a baby." src="ou_futurelearn_learn_to_code_fig_1047.jpg" /></p>
<p><strong>Figure 1</strong></p>
<p>Richer countries can afford to spend more on healthcare and on road safety, for example, to reduce mortality. On the other hand, richer countries may have less healthy lifestyles.</p>
<p>The World Bank provides loans and grants to governments of middle and low-income countries to help reduce poverty. As part of their work, the World Bank has put together hundreds of datasets on a range of issues, such as health, education, economy, energy and the effectiveness of aid in different countries. I will use two of their datasets, which you can see online by following the links below. You do not need to download the datasets.</p>
<p>One dataset lists the gross domestic product (GDP) for each country, in United States dollars and cents; the other lists the life expectancy, in years, for each country. The latest life expectancy data I can access is for 2013, so that will be the year I take for the GDP. The disadvantage of using the GDP and the life expectancy values for the same year is that they do not account for the time it takes for a country’s wealth to have an effect on lifestyle, healthcare and other factors influencing life expectancy.</p>
<p>While it is useful to have all GDPs in a common currency to compare different countries, it doesn’t make much sense to report the GDP of a whole country to a supposed precision of a US cent. I noted that the value for the USA is a round number, but it is not for other countries. This is likely due in part to the conversion of local currencies to US dollars. It makes more sense to report the GDP values in a larger unit, e.g. millions of dollars. Moreover, for those who don’t live in a country using the US dollar as the official currency, it’s probably easier to understand GDP values in their own local currency.</p>
<p>To sum up, this week’s project will transform currency values and combine GDP and life expectancy data.</p>
<p>Note that the combination is made simple by the common country names in the two datasets, but in general care has to be taken that the common attribute really means the same thing. For example, if you were combining two datasets on a common unemployment attribute, you must be sure that it was obtained in the same way as there are various ways of measuring unemployment.</p>
<p>I’m aware that the GDP is a crude way of comparing wealth across nations. For example, it doesn’t take population or the cost of living into account. Some of this week’s exercises will ask you to add the population data. Think of other ways to improve the analysis method, of other conversions that might be needed, and of other ways to investigate life expectancy factors.</p>
<hr class="docutils" />
<section id="links">
<h2>Links:<a class="headerlink" href="#links" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://data.worldbank.org/indicator/NY.GDP.MKTP.CD">GDP in current US dollars</a></p></li>
<li><p><a class="reference external" href="http://data.worldbank.org/indicator/SP.DYN.LE00.IN">Life expectancy at birth</a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="creating-the-data">
<h2>1.1 Creating the data<a class="headerlink" href="#creating-the-data" title="Permalink to this heading">#</a></h2>
<p>I won’t yet work with the full data. Instead I will create small tables, to better illustrate this week’s concepts and techniques.</p>
<p>Small tables make it easier to see what is going on and to create specific data combination and transformation scenarios that test the code.</p>
<p>There are many ways of creating tables in pandas. One of the simplest is to define the rows as a list, with the first element of the list being the first row, the second element being the second row, etc.</p>
<p>Each row of a table has multiple cells, one for each column. The obvious way is to represent each row as a list too, the first element of the list being the cell in the first column, the second element corresponding to the second column, etc. To sum up, the table is represented as a list of lists.</p>
<p>Here is a table of the 2013 GDP of some countries, in US dollars:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
<span class="p">[</span><span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="mf">2678454886796.7</span><span class="p">],</span> <span class="c1"># 1st row</span>
<span class="p">[</span><span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="mf">16768100000000.0</span><span class="p">],</span> <span class="c1"># 2nd row</span>
<span class="p">[</span><span class="s1">&#39;China&#39;</span><span class="p">,</span> <span class="mf">9240270452047.0</span><span class="p">],</span> <span class="c1"># and so on...</span>
<span class="p">[</span><span class="s1">&#39;Brazil&#39;</span><span class="p">,</span> <span class="mf">2245673032353.8</span><span class="p">],</span>
<span class="p">[</span><span class="s1">&#39;South Africa&#39;</span><span class="p">,</span> <span class="mf">366057913367.1</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>To create a dataframe, I use a pandas function appropriately called <code class="docutils literal notranslate"><span class="pre">DataFrame()</span></code>. I have to give it two arguments: the names of the columns and the data itself. The column names are given as a list of strings, the first string being the first column name, etc.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;GDP (US$)&#39;</span><span class="p">]</span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">headings</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
<span class="n">gdp</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country</th>
<th>GDP (US$)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">UK</td>
<td class="highlight_" rowspan="" colspan="">2.678455e+12</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">USA</td>
<td class="highlight_" rowspan="" colspan="">1.676810e+13</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">9.240270e+12</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Brazil</td>
<td class="highlight_" rowspan="" colspan="">2.245673e+12</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">South Africa</td>
<td class="highlight_" rowspan="" colspan="">3.660579e+11</td>
</tr>
</tbody>
</table>
<p>Note that pandas shows large numbers in scientific notation, where, for example, 3e+12 means 3×10 <sup xmlns:str="http://exslt.org/strings">12</sup> , i.e. a 3 followed by 12 zeros.</p>
<p>I define a similar table for the life expectancy, based on the 2013 World Bank data.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>

<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Country name&#39;</span><span class="p">,</span> <span class="s1">&#39;Life expectancy (years)&#39;</span><span class="p">]</span>

<span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
<span class="p">[</span><span class="s1">&#39;China&#39;</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span>
<span class="p">[</span><span class="s1">&#39;Russia&#39;</span><span class="p">,</span> <span class="mi">71</span><span class="p">],</span>
<span class="p">[</span><span class="s1">&#39;United States&#39;</span><span class="p">,</span> <span class="mi">79</span><span class="p">],</span>
<span class="p">[</span><span class="s1">&#39;India&#39;</span><span class="p">,</span> <span class="mi">66</span><span class="p">],</span>
<span class="p">[</span><span class="s1">&#39;United Kingdom&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">life</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">headings</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
<span class="n">life</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country name</th>
<th>Life expectancy (years)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">75</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">Russia</td>
<td class="highlight_" rowspan="" colspan="">71</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">United States</td>
<td class="highlight_" rowspan="" colspan="">79</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">India</td>
<td class="highlight_" rowspan="" colspan="">66</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">United Kingdom</td>
<td class="highlight_" rowspan="" colspan="">81</td>
</tr>
</tbody>
</table>
<p>To illustrate potential issues when combining multiple datasets, I’ve taken a different set of countries, with common countries in a different order. Moreover, to illustrate a non-numeric conversion, I’ve abbreviated country names in one table but not the other.</p>
<div class="admonition-activity-region-tags-style-activity admonition">
<p class="admonition-title">Activity<!-- #region tags=["style-activity"] --></p>
<p class="rubric">Exercise 1 Creating the data</p>
<p class="rubric">Question</p>
<p>Open the exercise notebook 3 and save it in the disk folder or upload it to the CoCalc project you created in Week 1. Then practise creating dataframes in Exercise 1.</p>
<p>If you’re using Anaconda, remember that to open the notebook you’ll need to navigate to it using Jupyter. Whether you’re using Anaconda or CoCalc, once the notebook is open, run the existing code before you start the exercise. When you’ve completed the exercise, save the notebook. If you need a quick reminder of how to use Jupyter, watch again the video in <a class="reference external" href="https://www.open.edu/openlearn/mod/oucontent/olink.php?id=83249&amp;targetdoc=Week+1%3A+Having+a+go+at+it+Part+1&amp;targetptr=1.4">Week 1 Exercise 1</a></p>
<!-- #endregion -->
</div>
</section>
<section id="defining-functions">
<h2>1.2 Defining functions<a class="headerlink" href="#defining-functions" title="Permalink to this heading">#</a></h2>
<p>To make the GDP values easier to read, I wish to convert US dollars to millions of US dollars.</p>
<p><img alt="An image of a large shipping container." src="ou_futurelearn_learn_to_code_fig_1048.jpg" /></p>
<p><strong>Figure 2</strong></p>
<p>I have to be precise about what I mean. For example, if the GDP is 4,567,890.1 (using commas to separate the thousands, millions, etc.), what do I want to obtain? Do I want always to round down to the nearest million, making it 4 million, round to the nearest million, making it 5, or round to one decimal place, making it 4.6 million? Since the aim is to simplify the numbers and not introduce a false sense of precision, let’s round to the nearest million.</p>
<p>I will define my own function to do such a conversion. It’s a generic function that takes any number and rounds it to the nearest million. I will later apply the function to each value in the GDP column. It’s easier to first show the code and then explain it.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">roundToMillions</span> <span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="n">result</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span> <span class="o">/</span> <span class="mi">1000000</span><span class="p">)</span>
<span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>A function definition always starts with <code class="docutils literal notranslate"><span class="pre">def</span></code> , which is a reserved word in Python.</p>
<p>After it comes the function’s name and arguments, surrounded by parenthesis, and finally a colon (:). This function just takes one argument. If there’s more than one argument, use commas to separate them.</p>
<p>Next comes the function’s body, where the calculations are done, using the arguments like any other variables. The body must be indented, conventionally by four spaces.</p>
<p>For this function, the calculation is simple. I take the value, divide it by one million, and call the built-in Python function <code class="docutils literal notranslate"><span class="pre">round()</span></code> to convert that number to the nearest integer. If the number is exactly mid-way between two integers, <code class="docutils literal notranslate"><span class="pre">round()</span></code> will pick the even integer, i.e. <code class="docutils literal notranslate"><span class="pre">round(2.5)</span></code> is 2 but <code class="docutils literal notranslate"><span class="pre">round(3.5)</span></code> is 4.Finally, I write a <strong>return statement</strong> to pass the result back to the code that called the function. The <code class="docutils literal notranslate"><span class="pre">return</span></code> word is also reserved in Python.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">result</span></code> variable just stores the rounded value temporarily and has no other purpose. It‘s better to write the body as a single line of code:</p>
<p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">round(value</span> <span class="pre">/</span> <span class="pre">1000000)</span></code></p>
<p>Finally I need to test the function, by calling it with various argument values and checking whether the returned value is equal to what I expect.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">roundToMillions(4567890.1)</span> <span class="pre">==</span> <span class="pre">5</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p>The art of testing is to find as few test cases as possible that cover all bases. And I mean all, especially those you think ‘Naaah, it’ll never happen’. It will, because data can be incorrect. Prepare for the worst and hope for the best.</p>
<p>So here are some more tests, even for the unlikely cases of the GDP being zero or negative, and you can probably think of others.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">roundToMillions(0)</span> <span class="pre">==</span> <span class="pre">0</span> <span class="pre">#</span> <span class="pre">always</span> <span class="pre">test</span> <span class="pre">with</span> <span class="pre">zero...</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">roundToMillions(-1)</span> <span class="pre">==</span> <span class="pre">0</span> <span class="pre">#...and</span> <span class="pre">negative</span> <span class="pre">numbers</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">roundToMillions(1499999)</span> <span class="pre">==</span> <span class="pre">1</span> <span class="pre">#</span> <span class="pre">test</span> <span class="pre">rounding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">nearest</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p>Now for the next conversion, from US dollars to a local currency, for example British pounds. I searched the internet for ‘average yearly USD to GBP rate’, chose a conversion service and took the value for 2013. Here’s the code and some tests.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">usdToGbp</span> <span class="p">(</span><span class="n">usd</span><span class="p">):</span>
<span class="k">return</span> <span class="n">usd</span> <span class="o">/</span> <span class="mf">1.564768</span> <span class="c1"># average rate during 2013</span>
<span class="n">usdToGbp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">usdToGbp(1.564768)</span> <span class="pre">==</span> <span class="pre">1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">usdToGbp(-1)</span> <span class="pre">&amp;lt;</span> <span class="pre">0</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p>Defining functions is such an important part of coding, that you should not skip the next exercise where you will define your own functions.</p>
<div class="admonition-activity-region-tags-style-activity admonition">
<p class="admonition-title">Activity<!-- #region tags=["style-activity"] --></p>
<p class="rubric">Exercise 2 Defining functions</p>
<p class="rubric">Question</p>
<p>Complete Exercise 2 in the Exercise notebook 3 to practise defining your own functions.</p>
<!-- #endregion -->
</div>
</section>
<section id="what-if">
<h2>1.3 What if…?<a class="headerlink" href="#what-if" title="Permalink to this heading">#</a></h2>
<p>The third conversion, from abbreviated country names to full names, can’t be written as a simple formula, because each abbreviation is expanded differently.</p>
<p><img alt="A world globe with pins all over the European continent" src="ou_futurelearn_learn_to_code_fig_1036.jpg" /></p>
<p><strong>Figure 3</strong></p>
<p>What I need is the Python code equivalent of:</p>
<ul class="simple">
<li><p>if the name is ‘UK’, return ‘United Kingdom’,</p></li>
<li><p>otherwise if the name is ‘USA’, return ‘United States’,</p></li>
<li><p>otherwise return the name.</p></li>
</ul>
<p>The last part basically says that if the name is none of the known abbreviations, return it unchanged. Translating the English sentence to Python is straightforward.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">expandCountry</span> <span class="p">(</span><span class="n">name</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;UK&#39;</span><span class="p">:</span> <span class="c1"># if the name is &#39;UK&#39;</span>
		<span class="k">return</span> <span class="s1">&#39;United Kingdom&#39;</span>
	
<span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;USA&#39;</span><span class="p">:</span> <span class="c1"># otherwise if the name is &#39;USA&#39;</span>

		<span class="k">return</span> <span class="s1">&#39;United States&#39;</span>
	<span class="k">else</span><span class="p">:</span> <span class="c1"># otherwise</span>
		<span class="k">return</span> <span class="n">name</span>
<span class="n">expandCountry</span><span class="p">(</span><span class="s1">&#39;India&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;India&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p>Note that ‘otherwise if’ is written <code class="docutils literal notranslate"><span class="pre">'elif'</span></code> in Python, not <code class="docutils literal notranslate"><span class="pre">'else</span> <span class="pre">if'</span></code>. As you might expect, ‘if’, ‘elif’ and ‘else’ are reserved words.</p>
<p>The computer will evaluate one condition at a time, from top to bottom, and execute only the instructions of the first condition that is true. Note that there is no condition after <code class="docutils literal notranslate"><span class="pre">'else'</span></code> , it is a ‘catch all’ in case all previous conditions fail.</p>
<p>Note again the colons at the end of lines and that code after the colon must be indented. That is how Python distinguishes which lines of code belong to which condition.</p>
<p>There are almost always many ways to write the same function. A <strong>conditional statement</strong> does not need to have an <code class="docutils literal notranslate"><span class="pre">'elif'</span></code> or <code class="docutils literal notranslate"><span class="pre">'else'</span></code> part. In that case, if the condition is false, nothing happens. Here is the same function, written differently.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">expandCountry</span> <span class="p">(</span><span class="n">name</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;UK&#39;</span><span class="p">:</span>
		<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;United Kingdom&#39;</span>
	<span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;USA&#39;</span><span class="p">:</span>
		<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;United States&#39;</span>
	<span class="k">return</span> <span class="n">name</span>
</pre></div>
</div>
<p>You will see later this week an example of an ‘if-else’ statement, i.e. without the <code class="docutils literal notranslate"><span class="pre">'elif'</span></code> part.</p>
<div class="admonition-activity-region-tags-style-activity admonition">
<p class="admonition-title">Activity<!-- #region tags=["style-activity"] --></p>
<p class="rubric">Exercise 3 What if…?</p>
<p class="rubric">Question</p>
<p>Complete Exercise 3 in the Exercise notebook 3 to practise writing functions with conditional statements.</p>
<!-- #endregion -->
</div>
</section>
<section id="applying-functions">
<h2>1.4 Applying functions<a class="headerlink" href="#applying-functions" title="Permalink to this heading">#</a></h2>
<p>Having coded the three data conversion functions, they can be applied to the GDP table.</p>
<p>I first select the relevant column:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">column</span> <span class="o">=</span> <span class="n">gdp</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span>
<span class="n">column</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="mi">0</span>              <span class="n">UK</span>
<span class="mi">1</span>             <span class="n">USA</span>
<span class="mi">2</span>           <span class="n">China</span>
<span class="mi">3</span>          <span class="n">Brazil</span>
<span class="mi">4</span>    <span class="n">South</span> <span class="n">Africa</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Country</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<p>Next, I use the column method <code class="docutils literal notranslate"><span class="pre">apply()</span></code> , which applies a given function to each cell in the column, returning a new column, in which each cell is the conversion of the corresponding original cell:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">column.apply(expandCountry)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="mi">0</span>    <span class="n">United</span> <span class="n">Kingdom</span>
<span class="mi">1</span>     <span class="n">United</span> <span class="n">States</span>
<span class="mi">2</span>             <span class="n">China</span>
<span class="mi">3</span>            <span class="n">Brazil</span>
<span class="mi">4</span>      <span class="n">South</span> <span class="n">Africa</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Country</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<p>Finally, I add that new column to the dataframe, using a new column heading:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]</span></code> :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">gdp</span><span class="p">[</span><span class="s1">&#39;Country name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">expandCountry</span><span class="p">)</span>
<span class="n">gdp</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country</th>
<th>GDP (US$)</th>
<th>Country name</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">UK</td>
<td class="highlight_" rowspan="" colspan="">2.678455e+12</td>
<td class="highlight_" rowspan="" colspan="">United Kingdom</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">USA</td>
<td class="highlight_" rowspan="" colspan="">1.676810e+13</td>
<td class="highlight_" rowspan="" colspan="">United States</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">9.240270e+12</td>
<td class="highlight_" rowspan="" colspan="">China</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Brazil</td>
<td class="highlight_" rowspan="" colspan="">2.245673e+12</td>
<td class="highlight_" rowspan="" colspan="">Brazil</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">South Africa</td>
<td class="highlight_" rowspan="" colspan="">3.660579e+11</td>
<td class="highlight_" rowspan="" colspan="">South Africa</td>
</tr>
</tbody>
</table>
<p>In a similar way, I can convert the US dollars to British pounds, then round to the nearest million, and store the result in a new column. I could apply the conversion and rounding functions in two separate statements, but using <strong>method chaining</strong> , I can apply both functions in a single line of code. This is possible because the column returned by the first call of <code class="docutils literal notranslate"><span class="pre">apply()</span></code> is the context for the second call of <code class="docutils literal notranslate"><span class="pre">apply()</span></code>. Here’s how it’s written:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">column</span> <span class="o">=</span> <span class="n">gdp</span><span class="p">[</span><span class="s1">&#39;GDP (US$)&#39;</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">usdToGbp</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">roundToMillions</span><span class="p">)</span>

<span class="n">gdp</span><span class="p">[</span><span class="s1">&#39;GDP (£m)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<span class="n">gdp</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country</th>
<th>GDP (US$)</th>
<th>Country name</th>
<th>GDP (£m)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">UK</td>
<td class="highlight_" rowspan="" colspan="">2.678455e+12</td>
<td class="highlight_" rowspan="" colspan="">United Kingdom</td>
<td class="highlight_" rowspan="" colspan="">1711727</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">USA</td>
<td class="highlight_" rowspan="" colspan="">1.676810e+13</td>
<td class="highlight_" rowspan="" colspan="">United States</td>
<td class="highlight_" rowspan="" colspan="">10716029</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">9.240270e+12</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">5905202</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Brazil</td>
<td class="highlight_" rowspan="" colspan="">2.245673e+12</td>
<td class="highlight_" rowspan="" colspan="">Brazil</td>
<td class="highlight_" rowspan="" colspan="">1435148</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">South Africa</td>
<td class="highlight_" rowspan="" colspan="">3.660579e+11</td>
<td class="highlight_" rowspan="" colspan="">South Africa</td>
<td class="highlight_" rowspan="" colspan="">233937</td>
</tr>
</tbody>
</table>
<p>Now it’s just a matter of selecting the two new columns, as the original ones are no longer needed.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Country name&#39;</span><span class="p">,</span> <span class="s1">&#39;GDP (£m)&#39;</span><span class="p">]</span>
<span class="n">gdp</span> <span class="o">=</span> <span class="n">gdp</span><span class="p">[</span><span class="n">headings</span><span class="p">]</span>
<span class="n">gdp</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings">
<caption></caption>
<tbody>
<tr>
<th></th>
<th>Country name</th>
<th>GDP (£m)</th>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__0__</td>
<td class="highlight_" rowspan="" colspan="">United Kingdom</td>
<td class="highlight_" rowspan="" colspan="">1711727</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__1__</td>
<td class="highlight_" rowspan="" colspan="">United States</td>
<td class="highlight_" rowspan="" colspan="">10716029</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__2__</td>
<td class="highlight_" rowspan="" colspan="">China</td>
<td class="highlight_" rowspan="" colspan="">5905202</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__3__</td>
<td class="highlight_" rowspan="" colspan="">Brazil</td>
<td class="highlight_" rowspan="" colspan="">1435148</td>
</tr>
<tr>
<td class="highlight_" rowspan="" colspan="">__4__</td>
<td class="highlight_" rowspan="" colspan="">South Africa</td>
<td class="highlight_" rowspan="" colspan="">233937</td>
</tr>
</tbody>
</table>
<p>Note that method chaining only works if the methods chained return the same type of value as their context, in the same way that you can chain multiple arithmetic operators (e.g. 3+4-5) because each one takes two numbers and returns a number that is used by the next operator in the chain. In this course, methods only have two possible contexts, columns and dataframes, so you can either chain column methods that return a single column (that is a <code class="docutils literal notranslate"><span class="pre">Series</span></code> ), like <code class="docutils literal notranslate"><span class="pre">apply()</span></code> , or dataframe methods that return dataframes. For example, <code class="docutils literal notranslate"><span class="pre">gdp.head(4).tail(2)</span></code> is a dataframe just with China and Brazil, i.e. the last two of the first four rows of the dataframe shown above. You’ll see further examples of chaining (and an easier way to select multiple rows) later this week.</p>
<p>This concludes the data transformation part. After applying functions in the next exercise, you’ll learn how to combine two tables.</p>
<div class="admonition-activity-region-tags-style-activity admonition">
<p class="admonition-title">Activity<!-- #region tags=["style-activity"] --></p>
<p class="rubric">Exercise 4 Applying functions</p>
<p class="rubric">Question</p>
<p>You can practise applying functions in Exercise 4 of your Exercise notebook 3.</p>
<!-- #endregion -->
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ouseful-demos/learn-to-code-jupyterlite",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="md_out_04_05.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">4.1 Week 4 glossary</p>
      </div>
    </a>
    <a class="right-next"
       href="md_out_05_02.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2 This week’s quiz</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#links">Links:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-data">1.1 Creating the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-functions">1.2 Defining functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-if">1.3 What if…?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-functions">1.4 Applying functions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By OpenLearn
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>